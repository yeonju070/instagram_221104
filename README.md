# instagram
나만의 인스타그램을 만들어보세요!<br>
사진을 올려 서로의 근황을 확인하고 팔로우를 통해 서로 가까워지고 소통할 수 있는 나만의 sns입니다.


## 프로젝트 주제 선정 이유
개인프로젝트가 시작되고 제가 할 수 있는 걸 최대한 이용해보기로 생각했습니다. 내가 어떤 것을 할 수 있는지 고민하며 어려운 기술들을 넣어 완성되지 못한 어설픈 결과물을 만드느니 완성도에 집중하려고 했고 일전에 sns를 조금 해본 경험을 토대로 표면적인 것들만 만들었던 sns에서 아쉬웠던 부분들을 조금더 세세히 보안하여 완성된 sns를 만들고 싶어서 이 프로젝트를 시작하게 되었습니다.


## 개요
### 프로젝트 일정
[개인프로젝트 기획서](https://ovenapp.io/view/a518sWUffUJ0LFCA5UFwKcKceCKJarWT#TUUFX) 작성 및 [일정표(wds)](https://docs.google.com/spreadsheets/d/1nWCcQ2uxeilCxMUCkrlJpY8r_5RhIo2I9wTOAgLvmPc/edit#gid=0)-> [DB설계](https://docs.google.com/spreadsheets/d/1TFikyslZJnriAMZxrpbF8gzqchIujMSILeB3M4-SN40/edit#gid=0) -> [API 및 URL 설계](https://docs.google.com/spreadsheets/d/1LaX4n7nSAR0B9mIBwdZJ_XEVHodPvFcjNHNYxWxjDJU/edit#gid=0) -> 마크업 및 기능 구현 -> 테스트 -> 완료

**개발 기간**<br>
2022-11-03 ~ 2022-12-14

## 개발 내용
### 기능
- 게시글 등록 및 삭제
- 좋아요 추가 및 제거(개수 출력)
- 댓글 등록 및 삭제(개수 출력)
- 프로필 이미지 등록 및 삭제
- 프로필 정보(내 정보) 업데이트 구현
- 팔로워 및 팔로우 수 출력<br>
- [기술 문서](https://www.notion.so/instagram-3c60c7a71b184753befa778f95678c5e)

### 향후 추가될 기능 및 예정
- 메시지 구현
- 팔로워 및 팔로우 정보 출력

## 트러블 슈팅
### 첫번째 오류
게시글 등록시 DB에 이미지가 저장된 것이 확인되나 화면에는 출력되지 않는다.<br>

**해결**<br>
img 파일에 이미지가 들어가 있는지 확인해 보았는데 이미지는 파일에 잘 저장되어있었다. controller에 디버그를 걸어서 확인해봤을 때 이미지는 잘 넘어와졌고 화면으로 뿌리는 과정에서 문제가 있다는 판단을 했다. 일단 DB에 담긴 이미지를 크롬에 검색해봤을때 이미지가 출력이 되지 않았고 WebmvcConfigurer에 어노테이션 @Configuration이 빠져있는 것을 발견하였다.<br>
하지만 어노테이션을 붙였는데도 화면에 뿌려지지 않는건 마찬가지였고 이미지를 크롬에 검색하였을때 이미지는 정상적으로 출력되는 것이 확인되었다. 이를 통해 DB오류가 아닌 jsp 오류라고 판단하였고 jsp확인 결과 게시글의 정보(list)가 담겨있는 cardView가 뿌려지고 있지 않다는 것을 발견하였고 cardview를 입력하고 나니 view가 정상 작동하였다.

### 두번째 오류
수정할 게시글의 더보기 modal에 있는 수정을 클릭하였을때 수정 페이지로 이동 불가 및 수정한 게시글만 가져오기 오류<br>

**해결**<br>
수정을 클릭하였는데 수정할 페이지로 이동이 되지 않아 앵커 태그에서 바로 보내는 것이 아닌 modal의 수정을 클릭하였을때 동작하도록 script를 열어 구성하였다.<br>
일단 더보기를 클릭하였을 때 동작하도록 하였고 누른 게시글을 data modal에 담았다. 그 후 modal의 수정을 클릭하였을 때 더보기에 담긴 data를 가져와 바로 get 방식으로 postId(게시글 번호)를 location.href로 바로 화면으로 뿌려주는 작업을 하였다.<br>
내가 원하는 게시글만 따로 get방식으로 가져오는 것은 완료 하였으나 내가 수정할 게시글만 가져오고 싶은데 게시글 전체가 화면에 뿌려지고 있었다. 확인하여 보니 게시글 전체가 담긴 cardView가 화면에 뿌려지고 있어서 전체가 출력되고 있다고 판단 하였고 게시글 하나만 출력 될 수 있도록 수정 view에 뿌릴 새로운 메소드를 만들었다. postId와 userId(누가 썼는지 확인 해야하기 때문)을 받아와 DB에서 정보들을 가져왔고 그것을 postList에 담아 화면에 출력하였더니 정상적으로 내가 수정할 게시글만 화면에 출력되는 것이 확인 되었다.

### 세번째 오류
유저 랜덤 추천 후 화면에 뿌리기(팔로우 관련)<br>

**해결**<br>
유저를 랜덤으로 추천할 리스트를 DB에서 가져와서 랜덤으로 추천할 메소드를 만든 후 DB에서 가져온 유저 정보들을 userList에 담아 주었다. 일단 첫번째로 해야 하는 것은 예외처리라고 생각하였다. 유저 리스트가 비어있을 때(가입한 회원이 없을 경우) 그냥 리턴을 시켜주는 예외 처리를 먼저 해주었다. 그 후 유저 추천 리스트에 내 정보가 추천 리스트에 뜨면 안되므로 반복문을 돌려야 겠다고 생각했다. userList(유저 정보가 담긴 객체)의 사이즈 만큼 반복문이 돌도록 하였고 userList의 i번째 index의 id(userList.get(i).getId())가 userId(Controller에서 가져온 userId == 나의 아이디)와 일치하면 나의 아이디가 되므로 remove를 해서 지워주는 작업을 하였다.<br>
이제 예외처리를 다 끝났으므로 본격적으로 유저 랜덤 추천을 시작하였다.<br>
random을 생성하여 주고 반복문으로 돌려주었다. int형에 랜덤 인덱스를 생성하여 userList의 size만큼 담았다. 그 후 model의 User객체를 가져와서 그것을 user에 담고 User를 배열문으로 만들어 반복문을 돌게 설정했다. 배열문의 0번째 index에 랜덤 인덱스를 담고 배열에 담긴 랜덤 인덱스에 tempUser(유저를 섞어야 하는 3번째 유저 정보)를 바꾸는 식으로 반복문을 돌려주었다.<br>

    for (int i = 0; i < 50; i++) {
			int rndIndex = rnd.nextInt(userList.size());
			User[] user;
			User tempUser = user[0];
			user[0] = user[rndIndex];
			user[rndIndex] = tempUser;
		}
    
하지만 위와 같은 방식으로 하니 에러가 발생하였고 랜덤으로 섞을 다른 방법을 생각해야 했다. 그러던 중 예전에 배웠던 방법 중 0번째 index와 랜덤으로 뽑은 유저를 서로 바꾸고 바뀐 0번째 index의 유저정보를 tempUser에 담아주어 이 과정을 반복하면서 섞는 구조가 생각났다.<br>

일단 만들어준 랜덤에 userList(유저 리스트의 담긴 유저 수)를 담고 그것을 int형으로 담아주었다. User객체의 tempUser(유저를 섞을 세번째 객체)에 userList의 첫번째 유저 정보를 담아주었다. 그 후 userList에 0번째 index에 임의로 뽑은 랜덤(위에서 생성한 int형)을 바꾸고 바꾼 랜덤 유저가 0번째에 index에 담기면 tempUser를 0번째로 설정하여 서로 서로 유저가 섞이게 설정하여주었다.(이 반복문을 50번 하여 유저를 섞어주었다.)<br>

    Random rnd = new Random();
	
		for (int i = 0; i < 50; i++) {
			int rndIndex = rnd.nextInt(userList.size());
			User tempUser = userList.get(0);
			userList.set(0, userList.get(rndIndex));	// 0번째 index에 랜덤 index입력
			userList.set(rndIndex, tempUser);			// 랜덤으로 섞인 index에 tempUser를 넣는다.
		}

위와 같이 반복문을 바꾸고나니 디버그를 걸었을때 유저가 정상적으로 섞이는 것을 확인하였다.

이 후 섞인 유저들을 4명만 출력하기를 원하였고 섞은 이후의 예외 처리를 해주었다. 일단 4명의 유저가 담겨있는지 확인해야해서 반복문을 돌려 랜덤으로 섞인 유저가 담긴 userListd의 size(index의 크기)가 4보다 작으면 그냥 return 해주었다. 위 반복문이 참이라면 밑으로 내려와 유저를 추천하는 유저가 담긴 리스트를 새로 만들어서 반복문을 돌려주었다. 4명의 유저만 추천할 것이기 때문에 i가 4 이하일때만 반복문이 돌도록 설정하여주었고 유저추천리스트를 담을 객체에 userList의 i번째 정보를 담아주고 그대로 리턴시켜 정보를 넘겨주었다.<br>

	List<User> userRecommentList = new ArrayList<>();
		for (int i = 0; i < 4; i++) {
			userRecommentList.add(userList.get(i));
		}
			
		return userRecommentList;

위 메소드를 timelineController에 model.addAttribute에 담아 타임라인에 뿌려주고 확인 해보았더니 정상 작동 하는 것이 확인되었다.

## 느낀점
처음 개인 프로젝트를 시작했을때 정말 막막해서 내가 정말 이 것을 할 수 있을지 의구심이 들었고 많이 불안했었다. 코딩에 대해 한번도 배워본적도 없었기 때문에 많이 힘들고 복잡한 심경으로 이 프로젝트를 시작했다. 개인 프로젝트를 진행하면서 그동안에 배웠던 기초들이 정말 많이 사용되고 응용해야 하는 것을 다시 한번 느꼈고 전에는 흐름이 잘 느껴지지 않았지만 프로젝트를 계속 하면서 이제 흐름이 서서히 보이기 시작하게 되었다. 내 손으로 화면을 구성하고 완성되어가는 과정을 보며 정말 많이 보람찼고 뿌듯했다. 또한 풀리지 않는 해결이 발생했을때 절망했지만 끊임 없는 검색과 고민을 끝으로 결과를 결국 찾아내어 문제를 해결하고 완성해가니 코딩의 재미가 이 것이었구나 세삼 느끼게 되었다. 많진 않지만 이 경험을 토대로 조금더 성장하여 이제 어느정도 스스로 해결하는 능력을 기른거 같다. 매우 값지고 유익한 시간이 된거 같다.
